<nav class="bg-white shadow-md fixed w-full z-50">
  <div class="container mx-auto flex items-center justify-between px-4 py-3">
    <!-- Brand -->
    <div class="flex-shrink-0">
      <a href="{% url 'home:doctor' %}"
        class="text-2xl font-bold bg-gradient-to-r from-indigo-500 to-purple-600 bg-clip-text text-transparent flex items-center">
        <i class="bi bi-heart-pulse-fill me-2 text-red-500"></i>CareMate
      </a>
    </div>

    <!-- Mobile toggle -->
    <button id="menu-toggle" class="lg:hidden text-gray-600 focus:outline-none ml-auto">
      <i class="bi bi-list text-2xl"></i>
    </button>

    <!-- Desktop Menu -->
    <div id="menu" class="hidden lg:flex items-center justify-between w-full">
      <!-- Search (centered only for patients) -->
      {% if request.user.role == 'patient' %}
      <div class="flex-grow flex justify-center">
        <form method="GET" action="{% url 'home:search' %}" class="w-full max-w-md">
          <input type="text" name="q" placeholder="Search..."
            class="w-full rounded-full px-4 py-2 border border-indigo-300 focus:ring-2 focus:ring-indigo-500 focus:outline-none">
        </form>
      </div>
      {% endif %}

      <!-- Right side (links + logout) -->
      <div class="flex items-center gap-6">
        {% if request.user.role == 'patient' %}
        <a href="{% url 'chat:doctor_conversations' %}" class="font-medium text-gray-700 hover:text-indigo-600">Chat</a>
        <a href="{% url 'home:doctor' %}" class="font-medium text-gray-700 hover:text-indigo-600">Home</a>
        <a href="{% url 'profile:view_appointments' %}"
          class="relative font-medium text-gray-700 hover:text-indigo-600">
          Appointments
          <span class="absolute -top-2 -right-3 text-xs bg-red-500 text-white rounded-full px-2 py-0.5">
            {{ count_of_notifications }}
          </span>
        </a>
        <a href="{% url 'profile:profile_patient' %}" class="font-medium text-gray-700 hover:text-indigo-600">Profile</a>
        {% endif %}

        <!-- Auth buttons -->
        <form method="post" action="{% url 'user_account:logout' %}">
          {% csrf_token %}
          <button type="submit"
            class="bg-gradient-to-r from-red-500 to-red-600 text-white rounded-full px-5 py-2 hover:from-red-600 hover:to-red-700 transition shadow-md">
            Logout
          </button>
        </form>
      </div>
    </div>
  </div>

  <!-- Mobile Menu -->
  <div id="mobile-menu" class="hidden flex-col gap-4 px-4 py-3 bg-white shadow-md lg:hidden">
    {% if request.user.role == 'patient' %}
    <form method="GET" action="{% url 'home:search' %}">
      <input type="text" name="q" placeholder="Search..."
        class="w-full rounded-full px-4 py-2 border border-indigo-300 focus:ring-2 focus:ring-indigo-500 focus:outline-none">
    </form>
    <a href="{% url 'chat:doctor_conversations' %}" class="font-medium text-gray-700 hover:text-indigo-600">Chat</a>
    <a href="{% url 'home:doctor' %}" class="font-medium text-gray-700 hover:text-indigo-600">Home</a>
    <a href="{% url 'profile:view_appointments' %}" class="font-medium text-gray-700 hover:text-indigo-600">Appointments</a>
    <a href="{% url 'profile:profile_patient' %}" class="font-medium text-gray-700 hover:text-indigo-600">Profile</a>
    {% endif %}

    {% if user.is_authenticated %}
    <form method="post" action="{% url 'user_account:logout' %}">
      {% csrf_token %}
      <button type="submit"
        class="bg-gradient-to-r from-red-500 to-red-600 text-white rounded-full px-5 py-2 hover:from-red-600 hover:to-red-700 transition w-full shadow-md">
        Logout
      </button>
    </form>
    {% else %}
    <a href="{% url 'user_account:login' %}"
      class="bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-full px-5 py-2 hover:from-indigo-600 hover:to-purple-700 transition text-center shadow-md">
      Login
    </a>
    <a href="{% url 'user_account:sign-up' %}"
      class="border border-indigo-500 text-indigo-500 rounded-full px-5 py-2 hover:bg-indigo-50 transition text-center shadow-md">
      Sign up
    </a>
    {% endif %}
  </div>
</nav>

<script>
  const toggle = document.getElementById("menu-toggle");
  const mobileMenu = document.getElementById("mobile-menu");

  toggle.addEventListener("click", () => {
    mobileMenu.classList.toggle("hidden");
  });
</script>
